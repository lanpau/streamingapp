---
phase: 01-foundation
plan: 01
type: execute
---

<objective>
Initialize FastAPI backend project with uv package manager and basic server configuration.

Purpose: Establish Python backend foundation that all streaming API features will build upon.
Output: Working FastAPI server with health endpoint, proper project structure, and uv-managed dependencies.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Phase 1 Goal:** Set up project structure with backend (FastAPI + uv) and iOS (Tuist) scaffolding

**Tech Decisions:**
- FastAPI for backend (per PROJECT.md)
- uv for package management (modern, fast alternative to poetry/pip)
- Python 3.12+ target
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Backend Project Structure</name>
  <files>backend/pyproject.toml, backend/src/app/__init__.py, backend/src/app/main.py, backend/.python-version</files>
  <action>
    1. Create `backend/` directory at project root
    2. Create `.python-version` with `3.12` (for uv to use correct Python)
    3. Create `pyproject.toml` with:
       - Project name: streamlive-api
       - Python >= 3.12
       - Dependencies: fastapi, uvicorn[standard], pydantic-settings
       - Dev dependencies: pytest, httpx (for testing)
       - Build system: hatchling
    4. Create `src/app/__init__.py` (empty, marks package)
    5. Create `src/app/main.py` with placeholder FastAPI app
    
    Use `src/` layout (src/app/) not flat layout — prevents import confusion.
    Do NOT use poetry or pip — uv only.
  </action>
  <verify>cd backend && uv sync && uv run python -c "from app.main import app; print('Import OK')"</verify>
  <done>pyproject.toml valid, uv sync succeeds, app module importable</done>
</task>

<task type="auto">
  <name>Task 2: Add FastAPI Server with Health Endpoint</name>
  <files>backend/src/app/main.py, backend/src/app/config.py</files>
  <action>
    1. Create `src/app/config.py` with pydantic-settings:
       - Settings class with: app_name, debug, host, port
       - Load from environment with sensible defaults
       - Use model_config for env prefix (STREAMLIVE_)
    
    2. Update `src/app/main.py`:
       - Create FastAPI app with title="StreamLive API", version="0.1.0"
       - Add CORSMiddleware (allow_origins=["*"] for dev, log warning about prod config)
       - Add GET /health returning {"status": "ok", "version": "0.1.0"}
       - Add GET / returning {"message": "StreamLive API", "docs": "/docs"}
    
    3. Add `if __name__ == "__main__"` block to run uvicorn directly
    
    Use pydantic-settings v2 syntax (SettingsConfigDict, not Config class).
    Do NOT hardcode configuration values in main.py — use config.py.
  </action>
  <verify>
    cd backend && uv run uvicorn app.main:app --host 0.0.0.0 --port 8000 &
    sleep 2
    curl -s http://localhost:8000/health | grep -q '"status":"ok"'
    curl -s http://localhost:8000/ | grep -q "StreamLive"
    kill %1
  </verify>
  <done>Server starts on port 8000, /health returns {"status": "ok"}, / returns API info, /docs shows Swagger UI</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd backend && uv sync` installs all dependencies
- [ ] `uv run uvicorn app.main:app --port 8000` starts without errors
- [ ] `curl http://localhost:8000/health` returns `{"status":"ok","version":"0.1.0"}`
- [ ] `http://localhost:8000/docs` shows Swagger UI
- [ ] No Python linting errors (if ruff/pyright installed)
</verification>

<success_criteria>

- Backend project structure created with src/ layout
- pyproject.toml valid with all dependencies
- FastAPI app runs with uvicorn
- Health endpoint returns proper JSON
- Configuration uses pydantic-settings
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md` with:
- One-liner about what was built
- Files created
- Any decisions made
- Next: Ready for 01-02-PLAN.md (iOS Tuist Init)
</output>
